# Toura APP

## External Links

Some useful documentation:

* https://github.com/Toura/toura_map/wiki

## APP Dev Setup:

### Setup Config.js

You need to setup your own toura/app/TouraConfig.js. See
toura/app/TouraConfig.js.example for information on how to setup the
TouraConfig.js file.

### Download local files

Some assets are stored locally in the app and rendered natively, instead of
over-the-air. You'll need to download the zip file from MAP and extract the
media directory and place it in: javascript/data-fixtures/media

At press-time, this URL is:
http://dev2.toura.com/tours/my-test-app--2/phone_gap_bundles/49.zip


### Run the tests

    rake

### Run JS unit tests

We have Evergreen setup to run Jasmine tests using Chrome. You must download chromedriver for your platform and place it somewhere in your path:

    which chromedriver
    http://code.google.com/p/chromium/downloads/list

Then run:

    rake spec # (is an alias for rake evergreen:run)

To repeatedly run a single test, do `rake evergreen:serve` and you can click into
a spec and repeatedly run it without having to rerun the entire suite.

### Dojo

The full Dojo SDK is 19mb; as such, we don't keep it in the repo. In order to
get started, you'll need to run `rake build:get_dojo` to download and extract
the Dojo SDK to the proper location. This rake task will also run as part of
the default rake task, and as part of certain build-related rake tasks.

#### Building Dojo for Development

In order to reduce the number of JavaScript files we have to download during
development, we generate a dojo.js for the sake of testing. This file is
generated by running `rake builder:app_dev`, which builds a dojo.js that combines
all of the Dojo resources required by the application. All Toura resources
are still loaded individually to facilitate debugging.

If you add a Dojo, Dijit, or Dojox resource to the application, you must add it
to the profile file that is used to build this dojo.js in order for it to be
included.  The profile file is located at profiles/browser-testing.js. Once you
have added a dependency to this file, you will need to re-run the `rake dev`
task to generate an updated dojo.js.

### Running a development server

    # run from toura_app root
    rake builder:app_dev
    rake serve

The application will be served on http://localhost:4000. Note that this will
fire a fresh Dojo build as well. If you already have a Dojo build and don't
need a fresh one, you can simply run:

    rake serve

### Building the app to test on device

    # run from toura_app root
    rake builder:dev:android
    rake builder:dev:iphone
    rake builder:dev:ipad

You can optionally pass `TOUR_ID=<tour_id>` to any of these tasks.

## Weinre

Weinre is a web inspector that works on a remote mobile device. See
http://pmuellr.github.com/weinre/

To use weinre, make sure that toura.isDebug is true. Then, click on the weinre
button in an instance of the app.
